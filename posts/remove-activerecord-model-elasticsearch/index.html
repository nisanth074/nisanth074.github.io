<html>
  <head>
  <title>Nisanth's Blog</title>
  <link rel="shortcut icon" href="/favicon-a409055.ico">

  

  
  <link rel="stylesheet" href="https://nisanth074.github.io//css/vendor/fonts.css">

  <link rel="stylesheet" href="https://nisanth074.github.io//bower_components/normalize.css/normalize.css">
  <link rel="stylesheet" href="https://nisanth074.github.io//css/reset.css">
  <link rel="stylesheet" href="https://nisanth074.github.io//css/main.css">
  <link rel="stylesheet" href="https://nisanth074.github.io//css/animations.css">

  
  <link rel="stylesheet" href="https://nisanth074.github.io//css/pygments-github.css">
</head>


  <body>
    <div class="main">
      <div class="header">
  <a href="https://nisanth074.github.io/">
    <img src="https://nisanth074.github.io//images/avatar.jpeg" class="avatar"></img>
  </a>
  <nav class="top-nav">
	  <ul>
	    <li><a href="/">Blog</a></li>
	    <li><a href="/books">Library</a></li>
	    <li><a href="/about">About</a></li>
	  </ul>
  </nav>
</div>


      <div class="page fade-in-up">
        <div class="post">
          <h1 class="post-title">Remove ActiveRecord model from ElasticSearch index with tire gem</h1>
          <p class="post-date">April 26, 2014</p>



          <div class="post-content"><p>Say, there is an ActiveRecord model <code>Ticket</code></p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">Ticket</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="kp">include</span> <span class="no">Tire</span><span class="o">::</span><span class="no">Model</span><span class="o">::</span><span class="no">Search</span>
  <span class="c1"># Tire gem setup...</span>
<span class="k">end</span>
</code></pre></div>


<p>and a <code>Ticket</code> document in ElasticSearch that you wish to delete. To delete the document, copy paste the following code in a rails console</p>

<p><div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">ticket_id</span> <span class="o">=</span> <span class="mi">1234</span>
<span class="n">document_id</span> <span class="o">=</span> <span class="n">ticket_id</span>
<span class="no">Ticket</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="no">Ticket</span><span class="o">.</span><span class="n">document_type</span><span class="p">,</span> <span class="n">document_id</span><span class="p">)</span>
</code></pre></div>
</p>

<p>This script is quite handy in situations where an ActiveRecord model was deleted from the database but the corresponding document wasn&rsquo;t deleted in Elasticsearch (due to network issues etc.)</p>
</div>
        </div>
      </div>
    </div>

    

<script src="https://nisanth074.github.io//js/twitterWidgets.js"></script>

  </body>
</html>
